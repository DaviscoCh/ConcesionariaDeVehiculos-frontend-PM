<div style="height: 55px;"></div>
<!-- VISTA 1: LOGIN NORMAL -->
<div class="login-container" *ngIf="!requiresTwoFactor">
  <div class="login-card">
    <div class="login-header">
      <h1>üöó CarPremier</h1>
      <p>Inicia sesi√≥n en tu cuenta</p>
    </div>

    <form [formGroup]="loginForm" (ngSubmit)="login()">
      <div class="form-group">
        <label for="correo">Correo Electr√≥nico</label>
        <input type="email" id="correo" formControlName="correo" placeholder="tucorreo@ejemplo.com" class="form-control"
          [class.invalid]="loginForm.get('correo')?.invalid && loginForm.get('correo')?.touched" />
        <small *ngIf="loginForm.get('correo')?.invalid && loginForm.get('correo')?.touched" class="error-text">
          Ingresa un correo v√°lido
        </small>
      </div>

      <div class="form-group">
        <label for="password">Contrase√±a</label>
        <input type="password" id="password" formControlName="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" class="form-control"
          [class.invalid]="loginForm.get('password')?.invalid && loginForm.get('password')?.touched" />
        <small *ngIf="loginForm.get('password')?.invalid && loginForm.get('password')?.touched" class="error-text">
          La contrase√±a es requerida
        </small>
      </div>

      <button type="submit" class="btn-primary" [disabled]="cargando || loginForm.invalid">
        <span *ngIf="!cargando">Iniciar Sesi√≥n</span>
        <span *ngIf="cargando">
          <i class="spinner"></i> Validando...
        </span>
      </button>
    </form>

    <div class="login-footer">
      <p>¬øNo tienes cuenta? <a routerLink="/registro-persona">Reg√≠strate aqu√≠</a></p>
    </div>
  </div>
</div>

<!-- VISTA 2: VERIFICACI√ìN 2FA -->
<div class="login-container" *ngIf="requiresTwoFactor">
  <div class="login-card verification-card">
    <div class="login-header">
      <div class="icon-2fa">üîê</div>
      <h1>Verificaci√≥n en Dos Pasos</h1>
      <p>Hemos enviado un c√≥digo de verificaci√≥n a:</p>
      <p class="email-highlight">{{ correoUsuario }}</p>
    </div>

    <form [formGroup]="codeForm" (ngSubmit)="verifyCode()">
      <div class="form-group">
        <label for="codigo">C√≥digo de Verificaci√≥n</label>
        <input type="text" id="codigo" formControlName="codigo" placeholder="000000" class="form-control code-input"
          maxlength="6" autocomplete="off"
          [class.invalid]="codeForm.get('codigo')?.invalid && codeForm.get('codigo')?.touched" />
        <small class="help-text">Ingresa el c√≥digo de 6 d√≠gitos</small>
        <small *ngIf="codeForm.get('codigo')?.invalid && codeForm.get('codigo')?.touched" class="error-text">
          El c√≥digo debe tener 6 d√≠gitos
        </small>
      </div>

      <button type="submit" class="btn-primary" [disabled]="cargando || codeForm.invalid">
        <span *ngIf="!cargando">Verificar C√≥digo</span>
        <span *ngIf="cargando">
          <i class="spinner"></i> Verificando...
        </span>
      </button>
    </form>

    <div class="verification-actions">
      <button type="button" class="btn-secondary" (click)="resendCode()" [disabled]="cargando">
        üîÑ Reenviar C√≥digo
      </button>
      <button type="button" class="btn-link" (click)="cancelVerification()">
        ‚Üê Volver al login
      </button>
    </div>

    <div class="info-box">
      <p>‚ö†Ô∏è El c√≥digo expira en 5 minutos</p>
      <p>Si no recibiste el c√≥digo, revisa tu carpeta de spam</p>
    </div>
  </div>
</div>